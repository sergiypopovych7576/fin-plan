<div *ngIf="!operations" class="d-flex p-2">
	<mat-spinner class="m-auto"></mat-spinner>
</div>
<div class="text-center" *ngIf="!operations.length; else grid">
	<b>
		<p>No data</p>
	</b>
</div>
<ng-template #grid>
	<div class="table-container">
		<table *ngIf="operations" mat-table [dataSource]="operations">
			<ng-container matColumnDef="color">
				<th mat-header-cell *matHeaderCellDef></th>
				<td mat-cell *matCellDef="let element" style="width: 5%">
					<fp-indicator [color]="element.category.color">
					</fp-indicator>
				</td>
				<td mat-footer-cell *matFooterCellDef></td>
			</ng-container>

			<ng-container matColumnDef="name" [sticky]="true">
				<th mat-header-cell *matHeaderCellDef>Name</th>
				<td mat-cell *matCellDef="let element" style="width: 27%">
					{{ element.name }}
				</td>
				<td mat-footer-cell *matFooterCellDef><b>Total</b></td>
			</ng-container>

			<ng-container matColumnDef="category" [sticky]="true">
				<th mat-header-cell *matHeaderCellDef>Category</th>
				<td mat-cell *matCellDef="let element" style="width: 27%">
					<div class="d-flex align-center">
						<mat-icon class="mr-1" [style.color]="element.category.color">{{ element.category.iconName }}</mat-icon>
						{{ element.category.name }}
					</div>
				
				</td>
				<td mat-footer-cell *matFooterCellDef></td>
			</ng-container>

			<ng-container matColumnDef="amount" [sticky]="true">
				<th mat-header-cell *matHeaderCellDef>Amount</th>
				<td mat-cell *matCellDef="let element" style="width: 20%" [class.color-red]="element.type === 1"
					[class.color-green]="element.type === 0" class="text-right">
					{{ element.amount | toMoney:'EUR' }}
				</td>
				<td mat-footer-cell *matFooterCellDef><b [class.color-red]="total < 0" [class.color-green]="total > 0">
						{{total | toMoney:'EUR'}}</b>
				</td>
			</ng-container>

			<ng-container matColumnDef="date" [sticky]="true">
				<th mat-header-cell *matHeaderCellDef>Date</th>
				<td mat-cell *matCellDef="let element" style="width: 15%">
					{{ element.date | date: 'dd/MM/yyyy'}}
				</td>
				<td mat-footer-cell *matFooterCellDef></td>
			</ng-container>

			<ng-container matColumnDef="actions">
				<th mat-header-cell *matHeaderCellDef></th>
				<td mat-cell *matCellDef="let element" style="width: 5%">
					<button class="action-button" mat-icon-button [matMenuTriggerFor]="actionsMenu">
						<mat-icon>more_vert</mat-icon>
					</button>
					<mat-menu #actionsMenu="matMenu" class="actions-menu">
						<button mat-button (click)="onDeleteClick(element)"><mat-icon>delete</mat-icon>Delete</button>
					</mat-menu>
				</td>
				<td mat-footer-cell *matFooterCellDef></td>
			</ng-container>

			<tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
			<tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
			<tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>
		</table>
	</div>
	<fp-progress-bar *ngIf="loading" mode="indeterminate"></fp-progress-bar>
</ng-template>